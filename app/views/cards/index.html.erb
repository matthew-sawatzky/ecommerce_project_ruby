<h1>All Cards</h1>

<details>
  <summary>Shopping Cart</summary>
  <% if @cart.empty? %>
    <p>No items in cart.</p>
  <% else %>
    <ul>
      <% @cart.each do |card| %>
        <li><%= card.name %> - <%= link_to 'remove from cart', remove_from_cart_path(card), method: :delete %></li>
      <% end %>
    </ul>
  <% end %>
</details>

<% if @cards.any? %>
  <div class="cards">
    <% @cards.each do |card| %>
      <div class="card">
        <h2><%= card.name %></h2>
        
        <% if card.image.attached? %>
          <%= image_tag url_for(card.image), alt: card.name %>
        <% else %>
          <% if card['images'] %>
            <%= image_tag card['images']['small'], alt: card.name %>
          <% end %>
        <% end %>
        
        <p><%= link_to 'Details', card_path(card) %></p>
        <% if @cart.include?(card) %>
          <p><%= button_to 'Remove from cart', remove_from_cart_path(card), method: :delete %></p>
        <% else %>
          <p><%= link_to 'Add to Cart', add_to_cart_path(card.id), data: { turbo_method: :post } %></p>
        <% end %>
      </div>
    <% end %>
  </div>
  <%= paginate @cards %>
<% else %>
  <p>No cards found.</p>
<% end %>
